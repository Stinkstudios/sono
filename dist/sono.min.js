!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.sono=n()}(this,function(){"use strict";function e(e){if("string"!=typeof e)return"";if("data:"===e.slice(0,5)){var n=e.match(/data:audio\/(ogg|mp3|opus|wav|m4a)/i);if(n&&n.length>1)return n[1].toLowerCase()}e=e.split("?")[0],e=e.slice(e.lastIndexOf("/")+1);var t=e.split(".");return 1===t.length||""===t[0]&&2===t.length?"":t.pop().toLowerCase()}function n(n){var t=void 0;if(Array.isArray(n))for(var r=0;r<n.length;r++){t=n[r];var o=e(t);if(te.indexOf(o)>-1)break}else"object"===("undefined"==typeof n?"undefined":Y(n))&&Object.keys(n).some(function(r){t=n[r];var o=e(t);return te.indexOf(o)>-1});return t||n}function t(e){return!!(e&&window.AudioBuffer&&e instanceof window.AudioBuffer)}function r(e){return!!(e&&window.ArrayBuffer&&e instanceof window.ArrayBuffer)}function o(e){return!!(e&&window.HTMLMediaElement&&e instanceof window.HTMLMediaElement)}function i(e){return!!(e&&"function"==typeof e.getAudioTracks&&e.getAudioTracks().length&&window.MediaStreamTrack&&e.getAudioTracks()[0]instanceof window.MediaStreamTrack)}function u(e){return!(!e||"string"!=typeof e||"sine"!==e&&"square"!==e&&"sawtooth"!==e&&"triangle"!==e)}function a(e){return!!(e&&"object"===("undefined"==typeof e?"undefined":Y(e))&&e.bufferSize&&e.channels&&e.callback)}function c(e){return!(!e||"string"!=typeof e||!(e.indexOf(".")>-1||"data:"===e.slice(0,5)))}function f(e){if(!e||o(e))return!1;var n=e.src||e.url||e.data||e;return c(n)||r(n)||Array.isArray(n)&&c(n[0])}function s(e,n){function t(e){var n=12*(Math.log(e/440)/Math.log(2));return Math.round(n)+69}function r(e){return 440*Math.pow(2,(e-69)/12)}function o(e,n){return Math.floor(1200*Math.log(e/r(n))/Math.log(2))}function i(e,n){return!e||(a.fftSize!==c||(!!(n&&e instanceof Uint8Array)||!n&&e instanceof Float32Array))}function u(e,n){return e?new Float32Array(n):new Uint8Array(n)}n=n||{};var a=e.createAnalyser(),c=n.fftSize||512,f=!!n.float,s=!!n.float,l=void 0,d=void 0;a.fftSize=c,a.smoothingTimeConstant=n.smoothing||n.smoothingTimeConstant||a.smoothingTimeConstant,a.minDecibels=n.minDecibels||a.minDecibels,a.maxDecibels=n.maxDecibels||a.maxDecibels;var v=new Blob(["onmessage=function(e){var data=e.data;var f=new Float32Array(data.b);for(var i=0;i<f.length;i++){data.sum+=f[i]}data.sum/=f.length;postMessage(Math.max(1.0-(data.sum/data.numSamples*-1.0),0))};"]),p=new Blob(["onmessage=function(e){var data=e.data;var sampleRate=data.sampleRate;var buf=new Float32Array(data.b);var SIZE=buf.length;var MAX_SAMPLES=Math.floor(SIZE/2);var best_offset=-1;var best_correlation=0;var rms=0;var foundGoodCorrelation=false;var correlations=new Array(MAX_SAMPLES);for(var i=0;i<SIZE;i++){var val=buf[i];rms+=val*val}rms=Math.sqrt(rms/SIZE);if (rms<0.01){postMessage(-1)}else{var lastCorrelation=1;for(var offset=0;offset<MAX_SAMPLES;offset++){var correlation=0;for(var i=0;i<MAX_SAMPLES;i++){correlation+=Math.abs((buf[i])-(buf[i+offset]))}correlation=1-(correlation/MAX_SAMPLES);correlations[offset]=correlation;if ((correlation>0.9)&&(correlation>lastCorrelation)){foundGoodCorrelation=true;if (correlation>best_correlation){best_correlation=correlation;best_offset=offset}}else if (foundGoodCorrelation){var shift=(correlations[best_offset+1]-correlations[best_offset-1])/correlations[best_offset];postMessage(sampleRate/(best_offset+(8*shift)))}lastCorrelation=correlation}if (best_correlation>0.01){postMessage(sampleRate/best_offset)}else{postMessage(-1)}}};"]),g=URL.createObjectURL(v),h=new Worker(g),m=URL.createObjectURL(p),y=new Worker(m),b=null,w=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],T=null,M={hertz:null,note:null,noteIndex:null,detuneCents:null,detune:null};return h.onmessage=function(e){b&&b(e.data)},y.onmessage=function(e){if(T){var n=e.data;if(n!==-1){var r=t(n),i=o(n,r);M.hertz=n,M.noteIndex=r%12,M.note=w[r%12],M.detuneCents=i,0===i?M.detune="":i<0?M.detune="flat":M.detune="sharp"}T(M)}},a.getWaveform=function(e){return arguments.length||(e=s),i(l,e)&&(c=a.fftSize,s=e,l=u(e,c)),e&&this.getFloatTimeDomainData?this.getFloatTimeDomainData(l):this.getByteTimeDomainData(l),l},a.getPitch=function(n){T=T||n;var t=new Float32Array(a.fftSize);t.set(a.getWaveform(!0)),y.postMessage({sampleRate:e.sampleRate,b:t.buffer},[t.buffer])},a.getFrequencies=function(e){return arguments.length||(e=f),i(d,e)&&(c=a.fftSize,f=e,d=u(e,a.frequencyBinCount)),e?this.getFloatFrequencyData(d):this.getByteFrequencyData(d),d},a.getAmplitude=function(e){b=b||e;var n=new Float32Array(a.fftSize);n.set(a.getFrequencies(!0)),h.postMessage({sum:0,length:n.byteLength,numSamples:a.fftSize/2,b:n.buffer},[n.buffer])},a.update=function(){a.getWaveform(),a.getFrequencies()},Object.defineProperties(a,{smoothing:{get:function(){return a.smoothingTimeConstant},set:function(e){a.smoothingTimeConstant=e}}}),a}function l(e,n){return arguments.length<2&&(n=0),"number"!=typeof e||isNaN(e)?n:e}function d(e,n){n=l(n,1);var t=e.createWaveShaper(),r=new Float32Array(ae);return t.update=function(e){if(n=e,n<=0)return n=0,void(this.curve=null);for(var t=100*e,o=Math.PI/180,i=void 0,u=0;u<ae;u++)i=2*u/ae-1,r[u]=(3+t)*i*20*o/(Math.PI+t*Math.abs(i));this.curve=r},Object.defineProperties(t,{amount:{get:function(){return n},set:function(e){this.update(e)}}}),"undefined"!=typeof n&&t.update(n),t}function v(e,n){n=n||{};var t=e.createGain(),r=e.createDelay(),o=e.createGain(),i=e.createGain();r.delayTime.value=l(n.delayTime,.5),o.gain.value=l(n.feedback,.5),t.connect(r),t.connect(i),r.connect(o),o.connect(r),o.connect(i);var u=t;return u.name="Echo",u._output=i,Object.defineProperties(u,{delay:{get:function(){return r.delayTime.value},set:function(e){r.delayTime.value=e}},feedback:{get:function(){return o.gain.value},set:function(e){o.gain.value=e}}}),u}function p(){function e(){}function n(){return{value:1,defaultValue:1,linearRampToValueAtTime:e,setValueAtTime:e,exponentialRampToValueAtTime:e,setTargetAtTime:e,setValueCurveAtTime:e,cancelScheduledValues:e}}function t(){return{connect:e,disconnect:e,frequencyBinCount:0,smoothingTimeConstant:0,fftSize:0,minDecibels:0,maxDecibels:0,getByteTimeDomainData:e,getByteFrequencyData:e,getFloatTimeDomainData:e,getFloatFrequencyData:e,gain:n(),panningModel:0,setPosition:e,setOrientation:e,setVelocity:e,distanceModel:0,refDistance:0,maxDistance:0,rolloffFactor:0,coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,type:0,frequency:n(),Q:n(),detune:n(),delayTime:n(),buffer:0,threshold:n(),knee:n(),ratio:n(),attack:n(),release:n(),reduction:n(),oversample:0,curve:0,sampleRate:1,length:0,duration:0,numberOfChannels:0,getChannelData:function(){return[]},copyFromChannel:e,copyToChannel:e,dopplerFactor:0,speedOfSound:0,start:e}}var r=Date.now();return window.Uint8Array||(window.Uint8Array=window.Float32Array=Array),{createAnalyser:t,createBuffer:t,createBiquadFilter:t,createChannelMerger:t,createChannelSplitter:t,createDynamicsCompressor:t,createConvolver:t,createDelay:t,createGain:t,createOscillator:t,createPanner:t,createScriptProcessor:t,createWaveShaper:t,listener:t(),get currentTime(){return(Date.now()-r)/1e3}}}function g(e){function n(e){var n=Math.log(o/r)/Math.LN2,t=Math.pow(2,n*(e-1));return o*t}var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=40,o=e.sampleRate/2,i=e.createBiquadFilter();return i.type=t.type,i.set=function(e,n,t){return"undefined"!=typeof e&&"number"==typeof e&&(i.frequency.value=e),"undefined"!=typeof n&&"number"==typeof n&&(i.Q.value=n),"undefined"!=typeof t&&"number"==typeof t&&(i.gain.value=t),i},i.setByPercent=function(e,t,r){return i.set(n(e),t,r)},i.set(t.frequency,t.q,t.gain)}function h(e,n){var t=e.createGain(),r=e.createDelay(),o=e.createGain(),i=e.createOscillator(),u=e.createGain(),a=e.createGain();r.delayTime.value=l(n.delay,.005),o.gain.value=l(n.feedback,.5),i.type="sine",i.frequency.value=l(n.frequency,.002),u.gain.value=l(n.gain,.25),t.connect(a),t.connect(r),r.connect(a),r.connect(o),o.connect(t),i.connect(u),u.connect(r.delayTime),i.start(0);var c=t;return c.name="Flanger",c._output=a,Object.defineProperties(c,{delay:{get:function(){return r.delayTime.value},set:function(e){r.delayTime.value=e}},lfoFrequency:{get:function(){return i.frequency.value},set:function(e){i.frequency.value=e}},lfoGain:{get:function(){return u.gain.value},set:function(e){u.gain.value=e}},feedback:{get:function(){return o.gain.value},set:function(e){o.gain.value=e}}}),c}function m(e,n){var t=e.createGain(),r=e.createChannelSplitter(2),o=e.createChannelMerger(2),i=e.createGain(),u=e.createGain(),a=e.createOscillator(),c=e.createGain(),f=e.createGain(),s=e.createDelay(),d=e.createDelay(),v=e.createGain();i.gain.value=u.gain.value=l(n.feedback,.5),s.delayTime.value=d.delayTime.value=l(n.delay,.003),a.type="sine",a.frequency.value=l(n.frequency,.5),c.gain.value=l(n.gain,.005),f.gain.value=0-c.gain.value,t.connect(r),r.connect(s,0),r.connect(d,1),s.connect(i),d.connect(u),i.connect(d),u.connect(s),s.connect(o,0,0),d.connect(o,0,1),o.connect(v),t.connect(v),a.connect(c),a.connect(f),c.connect(s.delayTime),f.connect(d.delayTime),a.start(0);var p=t;return p.name="StereoFlanger",p._output=v,Object.defineProperties(p,{delay:{get:function(){return s.delayTime.value},set:function(e){s.delayTime.value=d.delayTime.value=e}},lfoFrequency:{get:function(){return a.frequency.value},set:function(e){a.frequency.value=e}},lfoGain:{get:function(){return c.gain.value},set:function(e){c.gain.value=f.gain.value=e}},feedback:{get:function(){return i.gain.value},set:function(e){i.gain.value=u.gain.value=e}}}),p}function y(e,n){return n=n||{},n.stereo?new m(e,n):new h(e,n)}function b(e){function n(e,n){var t=e.x,r=e.y,o=e.z,i=n.x,u=n.y,a=n.z;e.x=r*a-o*u,e.y=o*i-t*a,e.z=t*u-r*i}function t(e){if(0===e.x&&0===e.y&&0===e.z)return e;var n=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z),t=1/n;return e.x*=t,e.y*=t,e.z*=t,e}function r(e,r){var o=u.get(r.x,r.y,r.z);n(o,a),n(o,r),t(o),t(r),e.setOrientation(r.x,r.y,r.z,o.x,o.y,o.z),u.dispose(r),u.dispose(o)}function o(e,n){e.setPosition(n.x,n.y,n.z),u.dispose(n)}var i=e.createPanner();i.panningModel=b.defaults.panningModel,i.distanceModel=b.defaults.distanceModel,i.refDistance=b.defaults.refDistance,i.maxDistance=b.defaults.maxDistance,i.rolloffFactor=b.defaults.rolloffFactor,i.coneInnerAngle=b.defaults.coneInnerAngle,i.coneOuterAngle=b.defaults.coneOuterAngle,i.coneOuterGain=b.defaults.coneOuterGain,i.setPosition(0,0,1),i.setOrientation(0,0,0);var u={pool:[],get:function(e,n,t){var r=this.pool.length?this.pool.pop():{x:0,y:0,z:0};return"undefined"!=typeof e&&isNaN(e)&&"x"in e&&"y"in e&&"z"in e?(r.x=l(e.x),r.y=l(e.y),r.z=l(e.z)):(r.x=l(e),r.y=l(n),r.z=l(t)),r},dispose:function(e){this.pool.push(e)}},a=u.get(0,1,0),c=Math.PI/4,f=Math.PI/2;return i.set=function(e,n,t){var r=u.get(e,n,t);1===arguments.length&&r.x&&(e=r.x,e>1&&(e=1),e<-1&&(e=-1),e*=c,t=e+f,t>f&&(t=Math.PI-t),r.x=Math.sin(e),r.z=Math.sin(t)),o(i,r)},i.setSourcePosition=function(e,n,t){o(i,u.get(e,n,t))},i.setSourceOrientation=function(e,n,t){r(i,u.get(e,n,t))},i.setListenerPosition=function(n,t,r){o(e.listener,u.get(n,t,r))},i.setListenerOrientation=function(n,t,o){r(e.listener,u.get(n,t,o))},i.getDefaults=function(){return b.defaults},i.setDefaults=function(e){Object.keys(e).forEach(function(n){b.defaults[n]=e[n]})},i}function w(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],t=l(n.stages,8),r=[],o=void 0,i=e.createGain(),u=e.createGain(),a=e.createOscillator(),c=e.createGain(),f=e.createGain();u.gain.value=l(n.feedback,.5),a.type="sine",a.frequency.value=l(n.frequency,.5),c.gain.value=l(n.gain,300);for(var s=0;s<t;s++)o=e.createBiquadFilter(),o.type="allpass",o.frequency.value=1e3*s,s>0&&r[s-1].connect(o),c.connect(o.frequency),r.push(o);var d=r[0],v=r[r.length-1];i.connect(d),i.connect(f),v.connect(f),v.connect(u),u.connect(d),a.connect(c),a.start(0);var p=i;return p.name="Phaser",p._output=f,Object.defineProperties(p,{lfoFrequency:{get:function(){return a.frequency.value},set:function(e){a.frequency.value=e}},lfoGain:{get:function(){return c.gain.value},set:function(e){c.gain.value=e}},feedback:{get:function(){return u.gain.value},set:function(e){u.gain.value=e}}}),p}function T(e,n){function t(e,n){for(var t=new Float32Array(n),r=0,o=0;o<e.length;o++)t.set(e[o],r),r+=e[o].length;return t}function r(){if(!a.length)return e.createBuffer(2,u,e.sampleRate);var n=a.length*u,r=e.createBuffer(2,n,e.sampleRate);return r.getChannelData(0).set(t(a,n)),r.getChannelData(1).set(t(c,n)),r}function o(){v&&(v.onaudioprocess=null,l.disconnect(),v.disconnect())}function i(){o(),v=e.createScriptProcessor(u,2,2),l.connect(v),v.connect(e.destination),v.connect(d),v.onaudioprocess=function(e){var t=e.inputBuffer.getChannelData(0),r=e.inputBuffer.getChannelData(1);if(n){var o=e.outputBuffer.getChannelData(0),i=e.outputBuffer.getChannelData(1);o.set(t),i.set(r)}p.isRecording&&(a.push(new Float32Array(t)),c.push(new Float32Array(r)))}}var u=4096,a=[],c=[],f=0,s=0,l=e.createGain(),d=e.createGain(),v=void 0,p=l;return p.name="Recorder",p._output=d,p.isRecording=!1,p.start=function(){i(),a.length=0,c.length=0,f=e.currentTime,s=0,this.isRecording=!0},p.stop=function(){return s=e.currentTime,this.isRecording=!1,o(),r()},p.getDuration=function(){return this.isRecording?e.currentTime-f:s-f},p}function M(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],t=e.sampleRate,r=l(n.time,1),o=l(n.decay,5),i=!!n.reverse,u=void 0,a=void 0,c=e.createGain(),f=e.createConvolver(),s=e.createGain();c.connect(f),c.connect(s),f.connect(s);var d=c;return d.name="Reverb",d._output=s,d.update=function(n){if("undefined"!=typeof n.time&&(r=n.time,u=Math.floor(t*r),a=u?e.createBuffer(2,u,t):null),"undefined"!=typeof n.decay&&(o=n.decay),"undefined"!=typeof n.reverse&&(i=n.reverse),!a)return void(f.buffer=null);for(var c=a.getChannelData(0),s=a.getChannelData(1),l=void 0,d=void 0,v=0;v<u;v++)l=i?u-v:v,d=Math.pow(1-l/u,o),c[v]=(2*Math.random()-1)*d,s[v]=(2*Math.random()-1)*d;f.buffer=a},d.update({time:r,decay:o,reverse:i}),Object.defineProperties(d,{time:{get:function(){return r},set:function(e){e!==r&&this.update({time:e})}},decay:{get:function(){return o},set:function(e){e!==o&&this.update({decay:e})}},reverse:{get:function(){return i},set:function(e){e!==i&&this.update({reverse:!!e})}}}),d}function A(e){function n(e,n){var t=e._output||e;t.disconnect(),t.connect(n)}function t(e){var t=X.length,r=t?X[t-1]:Z;r&&n(r,e),H=e}function r(){if(Z){for(var e=void 0,r=void 0,o=0;o<X.length;o++)e=X[o],r=0===o?Z:X[o-1],n(r,e);H&&t(H)}}function o(e){return!!e&&X.indexOf(e)>-1}function i(e){return e?o(e)?e:(X.push(e),r(),e):null}function u(e){if(!e)return null;if(!o(e))return e;for(var n=X.length,t=0;t<n;t++)if(e===X[t]){X.splice(t,1);break}var i=e._output||e;return i.disconnect(),r(),e}function a(e,n){n=!!n;var t=o(e);return arguments.length>1&&t===n?W:(t?u(e):i(e),W)}function c(){for(;X.length;)X.pop().disconnect();return r(),W}function f(){c(),e=null,H=null,X=[],Z&&Z.disconnect(),Z=null}function l(n){return i(new s(e,n))}function h(n){var t=e.createDynamicsCompressor();return t.update=function(e){t.threshold.value="undefined"!=typeof e.threshold?e.threshold:-24,t.knee.value="undefined"!=typeof e.knee?e.knee:30,t.ratio.value="undefined"!=typeof e.ratio?e.ratio:12,t.attack.value="undefined"!=typeof e.attack?e.attack:3e-4,t.release.value="undefined"!=typeof e.release?e.release:.25},t.update(n||{}),i(t)}function m(n){var t=e.createConvolver();return t.buffer=n,i(t)}function A(n){var t=e.createDelay();return"undefined"!=typeof n&&(t.delayTime.value=n),i(t)}function E(n){return i(new v(e,n))}function O(n){return i(new d(e,n))}function x(n,t,r,o){return i(new g(e,{type:n,frequency:t,q:r,gain:o}))}function S(e,n){return x("lowpass",{frequency:e,q:n})}function L(e,n){return x("highpass",{frequency:e,q:n})}function _(e,n){return x("bandpass",{frequency:e,q:n})}function C(e,n){return x("lowshelf",{frequency:e,q:0,gain:n})}function P(e,n){return x("highshelf",{frequency:e,q:0,gain:n})}function k(e,n,t){return x("peaking",{frequency:e,q:n,gain:t})}function D(e,n,t){return x("notch",{frequency:e,q:n,gain:t})}function R(e,n){return x("allpass",{frequency:e,q:n})}function q(n){return i(new y(e,n))}function F(n){var t=e.createGain();return"undefined"!=typeof n&&(t.gain.value=n),t}function z(){return i(new b(e))}function j(n){return i(new w(e,n))}function G(n){return i(new T(e,n))}function B(n,t,r){return i(new M(e,n,t,r))}function V(){var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=n.bufferSize||1024,r="undefined"==typeof n.inputChannels?0:n.inputChannels,o="undefined"==typeof n.outputChannels?1:n.outputChannels,u=e.createScriptProcessor(t,r,o),a=n.thisArg||n.context||u,c=n.callback||function(){};return u.onaudioprocess=c.bind(a),i(u)}function N(e){return Z=e,r(),e}function I(e){return t(e),e}e=e||new p;var U=new b(e),W=null,H=void 0,X=[],Z=void 0;return W={context:e,nodeList:X,panning:U,has:o,add:i,remove:u,toggle:a,removeAll:c,destroy:f,setSource:N,setDestination:I,analyser:l,compressor:h,convolver:m,delay:A,echo:E,distortion:O,filter:x,lowpass:S,highpass:L,bandpass:_,lowshelf:C,highshelf:P,peaking:k,notch:D,allpass:R,flanger:q,gain:F,panner:z,phaser:j,recorder:G,reverb:B,script:V},Object.freeze(W)}function E(e,n){function t(e,n){var t=void 0;return e||0===e?(m.some(function(n){return(n===e||n.id===e)&&(t=n,!0)}),t&&n?n(t):t):t}function r(e){return t(e,function(e){return m.splice(m.indexOf(e),1)}),T}function o(e){return e.gain.disconnect(),e.gain.connect(b),m.push(e),e.once("destroy",r),T}function i(e,n){return m.forEach(function(t){return t.play(e,n)}),T}function u(){return m.forEach(function(e){e.playing&&e.pause()}),T}function a(){return m.forEach(function(e){e.paused&&e.play()}),T}function c(){return m.forEach(function(e){return e.stop()}),T}function f(e){return m.forEach(function(n){return n.seek(e)}),T}function s(){return w=T.volume,T.volume=0,T}function l(){return T.volume=w||1,T}function d(e){return T.volume=e,T}function v(n,t){if(e){var r=b.gain,o=e.currentTime;r.cancelScheduledValues(o),r.setValueAtTime(r.value,o),r.linearRampToValueAtTime(n,o+t)}else m.forEach(function(e){return e.fade(n,t)});return T}function p(){m.forEach(function(e){return e.load(null,!0)})}function g(){m.forEach(function(e){return e.unload()})}function h(){for(;m.length;)m.pop().destroy()}var m=[],y=new A(e),b=y.gain(),w=1,T=null;return e&&(y.setSource(b),y.setDestination(n||e.destination)),T={add:o,find:t,remove:r,play:i,pause:u,resume:a,stop:c,seek:f,setVolume:d,mute:s,unMute:l,fade:v,load:p,unload:g,destroy:h},Object.defineProperties(T,{effect:{value:y},gain:{value:b},sounds:{value:m},volume:{get:function(){return b.gain.value},set:function(n){isNaN(n)||(n=Math.min(Math.max(n,0),1),e?(b.gain.cancelScheduledValues(e.currentTime),b.gain.value=n,b.gain.setValueAtTime(n,e.currentTime)):b.gain.value=n,m.forEach(function(e){e.context||(e.groupVolume=n)}))}}}),T}function O(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function x(e){return"function"==typeof e}function S(e){return"number"==typeof e}function L(e){return"object"==typeof e&&null!==e}function _(e){return void 0===e}function C(e,n){function t(){h.off("error"),h.off("progress"),h.off("complete"),h.off("loaded"),M&&"function"==typeof M.removeEventListener&&(M.removeEventListener("canplaythrough",c),M.removeEventListener("error",i)),w&&(w.removeEventListener("progress",o),w.removeEventListener("load",a),w.removeEventListener("error",i))}function r(e){h.emit("progress",1),h.emit("loaded",e),h.emit("complete",e),t()}function o(e){e.lengthComputable&&(m=e.loaded/e.total,h.emit("progress",m))}function i(n){window.clearTimeout(T);var r=n;M&&M.error&&(r="Media Error: "+g[M.error.code]+" "+e),w&&(r="XHR Error: "+w.status+" "+w.statusText+" "+e),h.emit("error",r),t()}function u(e){y.decodeAudioData(e,function(e){M=e,w=null,m=1,r(e)},i)}function a(){u(w.response)}function c(){window.clearTimeout(T),M&&(m=1,r(M))}function f(){t(),w&&4!==w.readyState&&w.abort(),w=null,window.clearTimeout(T)}function s(){f(),w=null,M=null,y=null}function l(){return e instanceof window.ArrayBuffer?void u(e):(w=new XMLHttpRequest,w.open("GET",e,!0),w.responseType="arraybuffer",w.addEventListener("progress",o),w.addEventListener("load",a),w.addEventListener("error",i),void w.send())}function d(){M&&M.tagName||(M=document.createElement("audio")),b||(window.clearTimeout(T),T=window.setTimeout(c,2e3),M.addEventListener("canplaythrough",c,!1)),M.addEventListener("error",i,!1),M.preload="auto",M.src=e,M.load(),b&&r(M)}function v(){var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0];n&&!e||(y?l():d())}function p(n){e=n,v()}var g=["","ABORTED","NETWORK","DECODE","SRC_NOT_SUPPORTED"],h=new se,m=0,y=void 0,b=void 0,w=void 0,T=void 0,M=void 0,A={on:h.on.bind(h),once:h.once.bind(h),off:h.off.bind(h),load:p,start:v,cancel:f,destroy:s};return Object.defineProperties(A,{data:{get:function(){return M}},progress:{get:function(){return m}},audioContext:{set:function(e){y=e}},isTouchLocked:{set:function(e){b=e}}}),Object.freeze(A)}function P(e,n,t){function r(){return!m&&n&&(m=n.createBufferSource(),m.buffer=e),m}function o(){if(m){m.onended=null;try{m.disconnect(),m.stop(0)}catch(e){}m=null}v=!1,p=0,h=!1,y=0}function i(){var e=n.currentTime-y;o(),p=e,h=!1,v=!0}function u(){o(),s=!0,"function"==typeof l&&l(f)}function a(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1];if(!h){for(e=e?n.currentTime+e:0,t&&(p=0),p&&(t=p);t>f.duration;)t%=f.duration;r(),m.onended=u,m.start(e,t),m.loop=d,m.playbackRate.value=g,y=n.currentTime-t,s=!1,v=!1,p=0,h=!0}}function c(){o(),e=null,n=null,l=null,m=null}var f={},s=!1,l=t,d=!1,v=!1,p=0,g=1,h=!1,m=null,y=0;return Object.defineProperties(f,{play:{value:a},pause:{value:i},stop:{value:o},destroy:{value:c},currentTime:{get:function(){if(p)return p;if(y){var e=n.currentTime-y;return e>f.duration&&(e%=f.duration),e}return 0}},duration:{get:function(){return e?e.duration:0}},ended:{get:function(){return s}},loop:{get:function(){return d},set:function(e){d=!!e,m&&(m.loop=d)}},paused:{get:function(){return v}},playbackRate:{get:function(){return g},set:function(e){g=e,m&&(m.playbackRate.value=g)}},playing:{get:function(){return h}},progress:{get:function(){return f.duration?f.currentTime/f.duration:0}},sourceNode:{get:function(){return r()}}}),Object.freeze(f)}function k(e,n,t,r){function o(){return p}function i(e){e.stop(),b&&h.push(e)}function u(e){if(m.length>1){var n=m.indexOf(e);m.splice(n,1)}i(e),r()}function a(){return!b&&m.length?m[0]:h.length>0?h.pop():(y++,n.tagName?new e(n.cloneNode(),t,u):new e(n,t,u))}function c(){var e=a();p&&e.sourceNode.connect(p),e!==m[0]&&m.push(e),e.play()}function f(){for(;m.length>1;)i(m.pop())}function s(){m.forEach(function(e){return e.pause()})}function l(e){f(),h.length=0,m.length&&m[0].load(e)}function d(e,n){m.forEach(function(t){return t.fade(e,n)})}function v(){for(;m.length;)m.pop().destroy();for(;h.length;)h.pop().destroy();p.disconnect()}var p=t?t.createGain():null,g={},h=[],m=[],y=0,b=!1;return Object.defineProperties(g,{play:{value:c},pause:{value:s},stop:{value:f},load:{value:l},fade:{value:d},destroy:{value:v},currentTime:{get:function(){return m[0]&&m[0].currentTime||0}},duration:{get:function(){return m[0]&&m[0].duration||0}},ended:{get:function(){return m.every(function(e){return e.ended})}},multiPlay:{get:function(){return b},set:function(e){b=e}},loop:{get:function(){return m[0]&&m[0].loop},set:function(e){m.forEach(function(n){return n.loop=!!e})}},paused:{get:function(){return m[0]&&m[0].paused}},playbackRate:{get:function(){return m[0]&&m[0].playbackRate},set:function(e){m.forEach(function(n){return n.playbackRate=e})}},playing:{get:function(){return m[0]&&m[0].playing}},info:{get:function(){return{pooled:h.length,active:m.length,created:y}}},progress:{get:function(){return m[0]&&m[0].progress}},sourceNode:{get:function(){return o()}},volume:{get:function(){return m[0]&&m[0].volume},set:function(e){m.forEach(function(n){return n.volume=e})}},groupVolume:{get:function(){return m[0]&&m[0].groupVolume},set:function(e){m[0]&&!m[0].hasOwnProperty("groupVolume")||m.forEach(function(n){return n.groupVolume=e})}}}),Object.freeze(g)}function D(e,n,t){function r(){return!T&&n&&(T=n.createMediaElementSource(e)),T}function o(n){e.src=n,e.load(),v=!1,y=!1,w=!1}function i(){e.removeEventListener("canplaythrough",i),w&&e.play()}function u(){return m?(e.currentTime=0,e.currentTime>0&&e.load(),void e.play()):(v=!0,y=!1,w=!1,void("function"==typeof p&&p(d)))}function a(n,t){clearTimeout(g),e.volume=A*M,e.playbackRate=b,t&&(e.currentTime=t),n?g=setTimeout(a,n):e.play(),v=!1,y=!1,w=!0,e.removeEventListener("ended",u),e.addEventListener("ended",u,!1),e.readyState<1&&(e.removeEventListener("canplaythrough",i),e.addEventListener("canplaythrough",i,!1),e.load(),e.play())}function c(){clearTimeout(g),e&&(e.pause(),w=!1,y=!0)}function f(){if(clearTimeout(g),e){e.pause();try{e.currentTime=0,e.currentTime>0&&e.load()}catch(e){}w=!1,y=!1}}function s(e,t){function r(e,n){h=window.setTimeout(function(){return d.volume=d.volume+.2*(e-d.volume),Math.abs(d.volume-e)>.05?void r(e,n):void(d.volume=e)},1e3*n)}return n?d:(window.clearTimeout(h),r(e,t/10),d)}function l(){e.removeEventListener("ended",u),e.removeEventListener("canplaythrough",i),f(),e=null,n=null,p=null,T=null}var d={},v=!1,p=t,g=void 0,h=void 0,m=!1,y=!1,b=1,w=!1,T=null,M=1,A=1;return Object.defineProperties(d,{play:{value:a},pause:{value:c},stop:{value:f},load:{value:o},fade:{value:s},destroy:{value:l},currentTime:{get:function(){return e?e.currentTime:0}},duration:{get:function(){return e?e.duration:0}},ended:{get:function(){return v}},loop:{get:function(){return m},set:function(e){m=!!e}},paused:{get:function(){return y}},playbackRate:{get:function(){return b},set:function(n){b=n,e&&(e.playbackRate=b)}},playing:{get:function(){return w}},progress:{get:function(){return e&&e.duration?e.currentTime/e.duration:0}},sourceNode:{get:function(){return r()}},volume:{get:function(){return A},set:function(n){window.clearTimeout(h),A=n,e&&(e.volume=A*M)}},groupVolume:{get:function(){return M},set:function(n){M=n,e&&(e.volume=A*M)}}}),Object.freeze(d)}function R(e,n){function t(){return!l&&n&&(l=n.createMediaStreamSource(e),navigator.mozGetUserMedia&&(window.mozHack=l)),l}function r(e){e=e?n.currentTime+e:0,t(),l.start(e),d=n.currentTime-f,a=!1,s=!0,c=!1,f=0}function o(){if(l){try{l.stop(0)}catch(e){}l=null}a=!0,c=!1,f=0,s=!1,d=0}function i(){var e=n.currentTime-d;o(),f=e,s=!1,c=!0}function u(){o(),n=null,l=null,e=null,window.mozHack=null}var a=!1,c=!1,f=0,s=!1,l=null,d=0,v={play:r,pause:i,stop:o,destroy:u,duration:0,progress:0};return Object.defineProperties(v,{currentTime:{get:function(){return f?f:d?n.currentTime-d:0}},ended:{get:function(){return a}},paused:{get:function(){return c}},playing:{get:function(){return s}},sourceNode:{get:function(){return t()}}}),Object.freeze(v)}function q(e,n){function t(){return!l&&n&&(l=n.createOscillator(),l.type=e,l.frequency.value=v),l}function r(e){e=e||0,e&&(e=n.currentTime+e),t(),l.start(e),d=f?n.currentTime-f:n.currentTime,a=!1,s=!0,c=!1,f=0}function o(){if(l){try{l.stop(0)}catch(e){}l=null}a=!0,c=!1,f=0,s=!1,d=0}function i(){var e=n.currentTime-d;o(),f=e,s=!1,c=!0}function u(){o(),n=null,l=null}var a=!1,c=!1,f=0,s=!1,l=null,d=0,v=200,p=null;return p={play:r,pause:i,stop:o,destroy:u},Object.defineProperties(p,{currentTime:{get:function(){return f?f:d?n.currentTime-d:0}},duration:{value:0},ended:{get:function(){return a}},frequency:{get:function(){return v},set:function(e){v=e,l&&(l.frequency.value=e)}},paused:{get:function(){return c}},playing:{get:function(){return s}},progress:{value:0},sourceNode:{get:function(){return t()}}}),Object.freeze(p)}function F(e,n){function t(){return!g&&n&&(g=n.createScriptProcessor(c,0,f)),g}function r(){t(),g.onaudioprocess=l,h=n.currentTime-v,s=!1,d=!1,v=0,p=!0}function o(e){for(var n=e.outputBuffer,t=0;t<n.numberOfChannels;t++)for(var r=n.getChannelData(t),o=0;o<r.length;o++)r[o]=0}function i(){g&&(g.onaudioprocess=o),s=!0,d=!1,v=0,p=!1,h=0}function u(){var e=n.currentTime-h;i(),v=e,p=!1,d=!0}function a(){i(),n=null,l=null,g=null}var c=e.bufferSize||1024,f=e.channels||1,s=!1,l=e.callback.bind(e.thisArg||this),d=!1,v=0,p=!1,g=null,h=0,m=null;return m={play:r,pause:u,stop:i,destroy:a,duration:0,progress:0},Object.defineProperties(m,{currentTime:{get:function(){return v?v:h?n.currentTime-h:0}},ended:{get:function(){return s}},paused:{get:function(){return d}},playing:{get:function(){return p}},sourceNode:{get:function(){return t()}}}),Object.freeze(m)}function z(){var e=void 0,n=void 0;return function(t,r){if(!window.Float32Array||!window.AudioBuffer)return[];var o=e===t,i=n&&n.length===r;if(o&&i)return n;if(n&&n.length===r||(n=new Float32Array(r)),!t)return n;e=t;for(var u=Math.floor(e.length/r),a=5,c=Math.max(Math.floor(u/a),1),f=0,s=0;s<e.numberOfChannels;s++)for(var l=e.getChannelData(s),d=0;d<r;d++)for(var v=d*u,p=v+u;v<p;v+=c){var g=l[v];g<0&&(g=-g),g>n[d]&&(n[d]=g),g>f&&(f=g)}for(var h=1/f,m=0;m<n.length;m++)n[m]*=h;return n}}function j(e){function n(){L.emit("ended",L)}function t(t){w=t;var r=ue.isAudioBuffer(w);if(r||ue.isMediaElement(w)){var o=r?P:D;S=new k(o,w,p,n),S.multiPlay=!!e.multiPlay}else if(ue.isMediaStream(w))S=new R(w,p);else if(ue.isOscillatorType(w&&w.type||w))S=new q(w.type||w,p);else{if(!ue.isScriptConfig(w))throw new Error("Cannot detect data type: "+w);S=new F(w,p)}h.setSource(S.sourceNode),L.emit("ready",L),x&&x()}function r(e){t(e),L.emit("loaded",L)}function o(e){L.emit("error",L,e)}function i(){var n=arguments.length<=0||void 0===arguments[0]?null:arguments[0],t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],i=!t&&!S&&!!e.deferLoad;if(n){var u=ue.getSupportedFile(e.src||e.url||e.data||e)||e.src;e=Object.assign(e,n,{src:u})}return S&&w&&w.tagName?S.load(e.src):(M=M||new C(e.src,i),M.audioContext=e.asMediaElement?null:p,M.isTouchLocked=T,M.off("loaded",r),M.once("loaded",r),M.off("error",o),M.on("error",o)),L}function u(n,t){return!S||T?(x=function(){S&&u(n,t)},e.deferLoad&&(M||i(null,!0),M.start(!0)),L):(x=null,h.setSource(S.sourceNode),p||(L.volume=m.gain.value),S.play(n,t),S.hasOwnProperty("loop")&&(S.loop=E),L.emit("play",L),L)}function a(){return S&&S.pause(),L.emit("pause",L),L}function c(e){return S&&S.stop(e||0),L.emit("stop",L),L}function f(e){return S&&(S.stop(),u(0,S.duration*e)),L}function s(e,n){if(!S)return L;var t=m.gain;if(p){var r=p.currentTime;t.cancelScheduledValues(r),t.setValueAtTime(t.value,r),t.linearRampToValueAtTime(e,r+n)}else"function"==typeof S.fade&&(S.fade(e,n),t.value=e);return L.emit("fade",L,e),L}function l(){S&&S.destroy(),M&&M.destroy(),w=null,x=null,S=null,M=null,e.deferLoad=!0,L.emit("unload",L)}function d(){i(null,!0)}function v(){S&&S.destroy(),h&&h.destroy(),m&&m.disconnect(),M&&M.off("loaded"),M&&M.off("error"),M&&M.destroy(),L.off("loaded"),L.off("ended"),L.off("error"),m=null,p=null,g=null,w=null,x=null,S=null,h=null,M=null,y=null,e=null,L.emit("destroy",L),L.off("destroy")}var p=e.context,g=e.destination,h=new A(p),m=h.gain(),y=z(),b=null,w=null,T=!1,M=null,E=!1,O=1,x=null,S=null,L=null;return p&&(h.setDestination(m),m.connect(g||p.destination)),L=Object.create(se.prototype,{_events:{value:{}},constructor:{value:j},play:{value:u},pause:{value:a},load:{value:i},seek:{value:f},stop:{value:c},fade:{value:s},unload:{value:l},reload:{value:d},destroy:{value:v},context:{value:p},currentTime:{get:function(){return S?S.currentTime:0},set:function(e){S&&S.stop(),u(0,e)}},data:{get:function(){return w},set:function(e){e&&t(e)}},duration:{get:function(){return S?S.duration:0}},effect:{value:h},ended:{get:function(){return!!S&&S.ended}},frequency:{get:function(){return S?S.frequency:0},set:function(e){S&&S.hasOwnProperty("frequency")&&(S.frequency=e)}},gain:{value:m},id:{get:function(){
return b},set:function(e){b=e}},isTouchLocked:{set:function(e){T=e,M&&(M.isTouchLocked=e),!e&&x&&x()}},loader:{get:function(){return M}},loop:{get:function(){return E},set:function(e){E=!!e,S&&S.hasOwnProperty("loop")&&S.loop!==E&&(S.loop=E)}},multiPlay:{get:function(){return e.multiPlay},set:function(n){e.multiPlay=n,S.multiPlay=n}},config:{get:function(){return e}},paused:{get:function(){return!!S&&S.paused}},playing:{get:function(){return!!S&&S.playing}},playbackRate:{get:function(){return O},set:function(e){O=e,S&&(S.playbackRate=O)}},progress:{get:function(){return S?S.progress:0}},sourceInfo:{get:function(){return S&&S.info?S.info:{}}},sourceNode:{get:function(){return S?S.sourceNode:null}},volume:{get:function(){return p?m.gain.value:S&&S.hasOwnProperty("volume")?S.volume:1},set:function(e){if(!isNaN(e)){e=Math.min(Math.max(e,0),1);var n=m.gain;if(p){var t=p.currentTime;n.cancelScheduledValues(t),n.value=e,n.setValueAtTime(e,t)}else n.value=e,S&&S.hasOwnProperty("volume")&&(S.volume=e)}}},groupVolume:{get:function(){return S.groupVolume},set:function(e){S&&S.hasOwnProperty("groupVolume")&&(S.groupVolume=e)}},waveform:{value:function(e){return w||L.once("ready",function(){return y(w,e)}),y(w,e)}},userData:{value:{}}})}function G(e,n){function t(){o.length&&(a=o.slice(0).sort(function(e,n){return n.duration-e.duration})[0])}var r=new E(e,n),o=r.sounds,i=1,u=!1,a=void 0,c=r.add;r.add=function(e){return c(e),t(),r};var f=r.rmeove;return r.remove=function(e){return f(e),t(),r},Object.defineProperties(r,{currentTime:{get:function(){return a?a.currentTime:0},set:function(e){this.stop(),this.play(0,e)}},duration:{get:function(){return a?a.duration:0}},loop:{get:function(){return u},set:function(e){u=!!e,o.forEach(function(e){e.loop=u})}},paused:{get:function(){return!!a&&a.paused}},progress:{get:function(){return a?a.progress:0}},playbackRate:{get:function(){return i},set:function(e){i=e,o.forEach(function(e){e.playbackRate=i})}},playing:{get:function(){return!!a&&a.playing}}}),r}function B(e,n,t){function r(){return i?(navigator.getUserMedia({audio:!0},function(n){a=n,e(a)},function(e){n&&"PermissionDeniedError"===e.name||"PERMISSION_DENIED"===e?n():t(e.message||e)}),u):u}function o(){return a&&(a.stop(),a=null),u}navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,t=t||function(){};var i=!!navigator.getUserMedia,u={},a=null;return Object.defineProperties(u,{connect:{value:r},disconnect:{value:o},isSupported:{value:i},stream:{get:function(){return a}}}),Object.freeze(u)}function V(e){function n(){f?(y.fillStyle=f,y.fillRect(d,v,h,m)):y.clearRect(d,v,h,m),y.lineWidth=s,b=null,"function"!=typeof c&&(y.strokeStyle=c,y.beginPath())}function t(e,n,t){if("function"==typeof c){var r=c(e,n,t);r!==b&&(b=r,y.stroke(),y.strokeStyle=b,y.beginPath())}}function r(e,n,t){return"function"==typeof p?p(e,n,t):e}function o(n,t){return n&&"function"==typeof n.waveform?n.waveform(t):n?n:e.waveform?e.waveform:e.sound?e.sound.waveform(t):null}function i(e){if(n(),"circular"===a){var i=o(e,360),c=Math.floor(i.length*l),f=de/c,p=void 0,g=void 0,b=void 0,S=void 0;for(w=0;w<c;w++){var L=r(i[w],w,c);t(w,c,L),p=w*f-le,S=Math.cos(p),b=Math.sin(p),"fill"===u&&(T=O+E*S,M=x+E*b,y.moveTo(T,M)),g=E+(A-E)*L,T=O+g*S,M=x+g*b,"line"===u&&0===w&&y.moveTo(T,M),y.lineTo(T,M)}"line"===u&&y.closePath()}else{var _=o(e,h),C=Math.min(_.length,h-s/2);for(C=Math.floor(C*l),w=0;w<C;w++){var P=r(_[w],w,C);t(w,C,P),"line"===u&&w>0&&y.lineTo(T,M),T=d+w,M=v+m-Math.round(m*P),M=Math.floor(Math.min(M,v+m-s/2)),"fill"===u?(y.moveTo(T,M),y.lineTo(T,v+m)):y.lineTo(T,M)}}y.stroke()}var u=e.style||"fill",a=e.shape||"linear",c=e.color||0,f=e.bgColor,s=e.lineWidth||1,l=e.percent||1,d=e.x||0,v=e.y||0,p=e.transform,g=e.canvas,h=e.width||g&&g.width,m=e.height||g&&g.height,y=null,b=void 0,w=void 0,T=void 0,M=void 0,A=void 0,E=void 0,O=void 0,x=void 0;return g||e.context||(g=document.createElement("canvas"),h=h||g.width,m=m||g.height,g.width=m,g.height=m),"circular"===a&&(A=e.radius||Math.min(m/2,h/2),E=e.innerRadius||A/2,O=d+h/2,x=v+m/2),y=e.context||g.getContext("2d"),i.canvas=g,(e.waveform||e.sound)&&i(),i}function N(){if(ve)return ve;var e=44100,n=window.AudioContext||window.webkitAudioContext;if(ve=n?new n:null,/(iPhone|iPad)/i.test(navigator.userAgent)&&ve.sampleRate!==e){var t=ve.createBuffer(1,1,e),r=ve.createBufferSource();r.buffer=t,r.connect(ve.destination),r.start(0),r.disconnect(),ve.close(),ve=n?new n:null}var o=ve&&"suspended"===ve.state;return o&&"function"==typeof ve.resume&&window.setTimeout(function(){ve.resume()},1e3),ve}function I(e,n,t){if(pe)return pe;e=e||2,t=t||44100,n=t||e;var r=window.OfflineAudioContext||window.webkitOfflineAudioContext;return pe=r?new r(e,n,t):null}function U(e){if(!ve)return e;for(var n=e.numberOfChannels,t=ve.createBuffer(n,e.length,e.sampleRate),r=0;r<n;r++)t.getChannelData(r).set(e.getChannelData(r));return t}function W(e){for(var n=e.numberOfChannels,t=0;t<n;t++)Array.prototype.reverse.call(e.getChannelData(t));return e}function H(e,n,t,r,o){ve&&(e.setValueAtTime(n,ve.currentTime),o?e.linearRampToValueAtTime(t,ve.currentTime+r):e.exponentialRampToValueAtTime(t,ve.currentTime+r))}function X(e){if(!ve)return 0;var n=40,t=ve.sampleRate/2,r=Math.log(t/n)/Math.LN2,o=Math.pow(2,r*(e-1));return t*o}function Z(e,n,t){return new B(e,n,t)}function Q(e){var n=arguments.length<=1||void 0===arguments[1]?":":arguments[1],t=Math.floor(e/60),r=Math.floor(e%3600%60),o=(t<10?"0"+t:t)+n,i=r<10?"0"+r:r;return o+i}function K(){function e(e){return T.find(e)}function n(e){var n=new G(b,T.gain);return e&&e.forEach(function(e){return n.add(e)}),n}function t(e){var n=e&&e.webAudio===!1?null:b,t=ue.getSupportedFile(e.src||e.url||e.data||e),r=new j(Object.assign({},e||{},{src:t,context:n,destination:T.gain}));return r.isTouchLocked=A,e&&(r.id=e.id||e.name||"",r.loop=!!e.loop,r.volume=e.volume),T.add(r),r}function r(e,n){var r=t(e).load();return n&&n.add(r.loader),r}function o(e){var n=e.src||e.url||e.data||e,t=void 0,o=void 0;if(ue.containsURL(n))t=r(e),o=t.loader;else{if(!Array.isArray(n)||!ue.containsURL(n[0].src||n[0].url)){var i="sono.load: No audio file URLs found in config.";if(!e.onError)throw new Error(i);return e.onError("[ERROR] "+i),null}t=[],o=new C.Group,n.forEach(function(e){return t.push(r(e,o))})}return e.onProgress&&o.on("progress",function(n){return e.onProgress(n)}),e.onComplete&&o.once("complete",function(){o.off("progress"),e.onComplete(t)}),o.once("error",function(n){o.off("error"),e.onError&&e.onError(n)}),o.start(),t}function i(e){if(ue.containsURL(e))return o(e);var n=t(e);return n.data=e.data||e,n}function u(e){return T.find(e,function(e){return e.destroy()}),M}function a(){return T.destroy(),M}function c(){return T.mute(),M}function f(){return T.unMute(),M}function s(e,n){return T.fade(e,n),M}function l(){return T.pause(),M}function d(){return T.resume(),M}function v(){return T.stop(),M}function p(e,n,t){return T.find(e,function(e){return e.play(n,t)}),M}function g(e){return T.find(e,function(e){return e.pause()}),M}function h(e){return T.find(e,function(e){return e.stop()}),M}function m(){var e="sono "+y,n="Supported:"+M.isSupported+" WebAudioAPI:"+M.hasWebAudio+" TouchLocked:"+A+" State:"+(b&&b.state)+" Extensions:"+ue.extensions;if(navigator.userAgent.indexOf("Chrome")>-1){var t=["%c ♫ "+e+" ♫ %c "+n+" ","color: #FFFFFF; background: #379F7A","color: #1F1C0D; background: #E0FBAC"];console.log.apply(console,t)}else window.console&&window.console.log.call&&console.log.call(console,e+" "+n)}var y="0.1.85",b=ge.getContext(),w=b?b.destination:null,T=new E(b,w),M=null,A=!1;return A=J.handleTouchLock(b,function(){A=!1,T.sounds.forEach(function(e){return e.isTouchLocked=!1})}),function(){function e(){T.sounds.forEach(function(e){e.playing&&(e.pause(),t.push(e))})}function n(){for(;t.length;)t.pop().play()}var t=[];J.handlePageVisibility(e,n)}(),M={createSound:i,create:i,destroySound:u,destroyAll:a,getSound:e,createGroup:n,file:ue,load:o,mute:c,unMute:f,fade:s,pauseAll:l,resumeAll:d,stopAll:v,play:p,pause:g,stop:h,log:m,canPlay:ue.canPlay,context:b,getOfflineContext:ge.getOfflineContext,effect:T.effect,extensions:ue.extensions,hasWebAudio:!!b,isSupported:ue.extensions.length>0,gain:T.gain,utils:ge,VERSION:y,Sound:j,Group:E},Object.defineProperties(M,{isTouchLocked:{get:function(){return A}},sounds:{get:function(){return T.sounds.slice(0)}},volume:{get:function(){return T.volume},set:function(e){T.volume=e}}}),Object.freeze(M)}var J={};J.handlePageVisibility=function(e,n){function t(){document[r]?e():n()}var r=void 0,o=void 0;"undefined"!=typeof document.hidden?(r="hidden",o="visibilitychange"):"undefined"!=typeof document.mozHidden?(r="mozHidden",o="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(r="msHidden",o="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(r="webkitHidden",o="webkitvisibilitychange"),"undefined"!=typeof o&&document.addEventListener(o,t,!1)},J.handleTouchLock=function(e,n){function t(){e&&"suspended"===e.state?e.resume().then(function(){var r=e.createBuffer(1,1,44100),o=e.createBufferSource();o.buffer=r,o.connect(e.destination),o.start(0),o.stop(0),o.disconnect(),document.body.removeEventListener("touchend",t),n()}):(document.body.removeEventListener("touchend",t),n())}var r=navigator.userAgent,o=!!r.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Windows Phone|SymbianOS/i);return o&&document.body.addEventListener("touchend",t,!1),o};var Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},$=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},ee=function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)},ne=function(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n},te=[],re={},oe=[{ext:"ogg",type:'audio/ogg; codecs="vorbis"'},{ext:"mp3",type:"audio/mpeg;"},{ext:"opus",type:'audio/ogg; codecs="opus"'},{ext:"wav",type:'audio/wav; codecs="1"'},{ext:"m4a",type:"audio/x-m4a;"},{ext:"m4a",type:"audio/aac;"}],ie=document.createElement("audio");ie&&(oe.forEach(function(e){var n=!!ie.canPlayType(e.type);n&&te.indexOf(e.ext)===-1&&te.push(e.ext),re[e.ext]=n}),ie=null);var ue={canPlay:re,containsURL:f,extensions:te,getFileExtension:e,getSupportedFile:n,isAudioBuffer:t,isMediaElement:o,isMediaStream:i,isOscillatorType:u,isScriptConfig:a,isURL:c},ae=22050;b.defaults={panningModel:"HRTF",distanceModel:"linear",refDistance:1,maxDistance:1e3,rolloffFactor:1,coneInnerAngle:360,coneOuterAngle:0,coneOuterGain:0},E.Effect=A;var ce=O;O.EventEmitter=O,O.prototype._events=void 0,O.prototype._maxListeners=void 0,O.defaultMaxListeners=10,O.prototype.setMaxListeners=function(e){if(!S(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},O.prototype.emit=function(e){var n,t,r,o,i,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||L(this._events.error)&&!this._events.error.length)){if(n=arguments[1],n instanceof Error)throw n;var a=new Error('Uncaught, unspecified "error" event. ('+n+")");throw a.context=n,a}if(t=this._events[e],_(t))return!1;if(x(t))switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),t.apply(this,o)}else if(L(t))for(o=Array.prototype.slice.call(arguments,1),u=t.slice(),r=u.length,i=0;i<r;i++)u[i].apply(this,o);return!0},O.prototype.addListener=function(e,n){var t;if(!x(n))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,x(n.listener)?n.listener:n),this._events[e]?L(this._events[e])?this._events[e].push(n):this._events[e]=[this._events[e],n]:this._events[e]=n,L(this._events[e])&&!this._events[e].warned&&(t=_(this._maxListeners)?O.defaultMaxListeners:this._maxListeners,t&&t>0&&this._events[e].length>t&&(this._events[e].warned=!0,"function"==typeof console.trace)),this},O.prototype.on=O.prototype.addListener,O.prototype.once=function(e,n){function t(){this.removeListener(e,t),r||(r=!0,n.apply(this,arguments))}if(!x(n))throw TypeError("listener must be a function");var r=!1;return t.listener=n,this.on(e,t),this},O.prototype.removeListener=function(e,n){var t,r,o,i;if(!x(n))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(t=this._events[e],o=t.length,r=-1,t===n||x(t.listener)&&t.listener===n)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,n);else if(L(t)){for(i=o;i-- >0;)if(t[i]===n||t[i].listener&&t[i].listener===n){r=i;break}if(r<0)return this;1===t.length?(t.length=0,delete this._events[e]):t.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,n)}return this},O.prototype.removeAllListeners=function(e){var n,t;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(n in this._events)"removeListener"!==n&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events={},this}if(t=this._events[e],x(t))this.removeListener(e,t);else if(t)for(;t.length;)this.removeListener(e,t[t.length-1]);return delete this._events[e],this},O.prototype.listeners=function(e){var n;return n=this._events&&this._events[e]?x(this._events[e])?[this._events[e]]:this._events[e].slice():[]},O.prototype.listenerCount=function(e){if(this._events){var n=this._events[e];if(x(n))return 1;if(n)return n.length}return 0},O.listenerCount=function(e,n){return e.listenerCount(n)};var fe=ce.EventEmitter,se=function(e){function n(){return $(this,n),ne(this,e.call(this))}return ee(n,e),n.prototype.off=function(e,n){return n?this.removeListener(e,n):e?this.removeAllListeners(e):this.removeAllListeners()},n}(fe);C.Group=function(){function e(e){var n=f+e;a.emit("progress",n/s)}function n(){f++,o(),a.emit("progress",f/s),r()}function t(e){o(),a.emit("error",e),r()}function r(){return 0===c.length?(l=null,void a.emit("complete")):(l=c.pop(),l.on("progress",e),l.once("loaded",n),l.once("error",t),void l.start())}function o(){l.off("progress",e),l.off("loaded",n),l.off("error",t)}function i(e){return c.push(e),s++,e}function u(){s=c.length,r()}var a=new se,c=[],f=0,s=0,l=void 0;return Object.freeze({on:a.on.bind(a),once:a.once.bind(a),off:a.off.bind(a),add:i,start:u})},j.__source={BufferSource:P,MediaSource:D,MicrophoneSource:R,OscillatorSource:q,ScriptSource:F};var le=Math.PI/2,de=2*Math.PI,ve=void 0,pe=void 0,ge=Object.freeze({getContext:N,getOfflineContext:I,cloneBuffer:U,reverseBuffer:W,ramp:H,getFrequency:X,microphone:Z,timeCode:Q,waveformer:V}),he=new K;return he});
